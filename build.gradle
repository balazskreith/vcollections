plugins {
    id 'maven-publish'
    id 'java'
    id "com.jfrog.bintray" version "1.8.4"
}


allprojects {

    apply plugin: 'maven'
    apply plugin: 'maven-publish'
    apply plugin: 'java'
    apply plugin: 'com.jfrog.bintray'

    sourceCompatibility = 1.12
    targetCompatibility = 1.12

    repositories {
        mavenCentral()
        jcenter()
    }

    group = 'com.wobserver.vcollections'

    task hello {
        doLast { task ->
            println "I'm $task.project.name"
        }
    }

    test {
        useJUnitPlatform()
    }

    dependencies {
        testImplementation 'org.junit.jupiter:junit-jupiter-api:5.4.2'
        testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.4.2'
    }
}
subprojects {
    hello {
        doLast {
            println "vcollectinos-${project.name}"
        }
    }
    ext.publish = true
    bintray {
        user = 'balazskreith'
        key = '75ad9d231b2e61cdc114f4900a147abd0bb1093d'
        publications = ['vcollections']
        pkg {
            repo = 'vcollections'
            name = "vcollectinos-${project.name}"
            userOrg = 'wobserver'
            licenses = ['AGPL-V3']
            websiteUrl = 'https://github.com/balazskreith/vcollections/'
            issueTrackerUrl = 'https://github.com/balazskreith/vcollections/issues'
            vcsUrl = 'https://github.com/balazskreith/vcollections.git'
            labels = ['collections', 'virtualization']
            publicDownloadNumbers = true
            version {
                name = project.version
                desc = project.desc
                vcsTag = project.version
            }
        }
    }

    publishing {
        publications {
            vcollections(MavenPublication) {
                from components.java
                groupId project.group
                artifactId "vcollectinos-${project.name}"
                version project.version
            }
        }
    }
}